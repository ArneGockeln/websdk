{% extends 'base.twig' %}

{% block content %}
    <div class="row">
        <div class="col-md-12">
            <div class="page-header">
                <h1>{% trans 'Seminare' %} {% if not isAdmin %}<small class="pull-right btn-add"><a href="{{ siteurl }}/events/add" class="btn btn-primary btn-with-spinner"><i class="fa fa-plus"></i> {% trans 'Neues Seminar' %}</a></small>{% endif %}</h1>
            </div>

            <div class="well well-sm">
                <form action="{{ siteurl }}/events" method="post" name="filterForm" id="filterForm">
                    <input type="hidden" name="inputIsFilter" value="1">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label for="inputFilterDate">{% trans 'Datum' %}</label>
                                <input type="text" name="inputFilterDate" id="inputFilterDate" class="form-control" value="{{ filter['inputFilterDate'] }}" placeholder="2015-12-31" data-mask="0000-00-00">
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label for="inputFilterStatus">{% trans 'Status' %}</label>
                                <select name="inputFilterStatus" id="inputFilterStatus" class="form-control">
                                    <option value="-1" {% if filter['inputFilterStatus']|length == 0 %}selected{% endif %}>--{% trans 'Bitte wählen' %}--</option>
                                    {% for status in stati %}
                                        <option value="{{ status['id'] }}" {% if (filter['inputFilterStatus']|length > 0) and (filter['inputFilterStatus'] == status['id']) %}selected{% endif %}>{{ status['name'] }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        <div class="col-md-3">
                            {% if isAdmin %}
                            <div class="form-group">
                                <label for="inputFilterUser">{% trans 'Veranstalter' %}</label>
                                <select name="inputFilterUser" id="inputFilterUser" class="form-control">
                                    <option value="-1" {% if filter['inputFilterUser']|length == 0 %}selected{% endif %}>--{% trans 'Bitte wählen' %}--</option>
                                    {% for owner in ownerUsers %}
                                        <option value="{{ owner['id'] }}" {% if filter['inputFilterUser'] == owner['id'] %}selected{% endif %}>{{ owner['firstname'] }} {{ owner['lastname'] }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            {% endif %}
                        </div>
                        <div class="col-md-3">
                            <div class="form-group btn-filter-margin">
                                <button type="submit" name="inputFilterSubmit" class="btn btn-default btn-with-spinner">{% trans 'Filter' %}</button>
                                <div class="checkbox pull-right">
                                    <label for="inputFilterReset">
                                        <input type="checkbox" name="inputFilterReset" id="inputFilterReset" value="1">
                                        {% trans 'zurücksetzen' %}
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <div class="panel panel-default">
                <table class="table table-striped table-hover">
                    <thead>
                    <tr>
                        <th>{% trans 'Datum' %}</th>
                        <th>{% trans 'Status' %}</th>
                        {% if isAdmin %}
                        <th>{% trans 'Veranstalter' %}</th>
                        {% endif %}
                        <th>{% trans 'Titel' %}</th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody>
                    {% if events|length > 0 %}
                        {% for event in events %}
                            <tr>
                                <td>{{ event['startdate']|date("d.m.Y") }}{% if event['enddate'] != '0000-00-00' %} - {{ event['enddate']|date("d.m.Y") }}{% endif %}</td>
                                <td>{{ eventStatusName(event['status'], true)|replace({",": "<br/>"})|raw  }}</td>
                                {% if isAdmin %}
                                <td>{% if event['event_user_name']|length > 2 %}{{ event['event_user_name'] }}{% else %}{{ event['username'] }}{% endif %}</td>
                                {% endif %}
                                <td><a href="{{ siteurl }}/events/view/{{ event['id'] }}">{{ event['title'] }}</a></td>
                                <td>
                                    <div class="btn-group btn-group-sm" role="group" style="display:flex;">
                                        {% if event['isEditable'] %}
                                            <a href="{{ siteurl }}/events/edit/{{ event['id'] }}" class="btn btn-default btn-with-spinner" title="{% trans 'bearbeiten' %}" data-toggle="tooltip" data-placement="top"><i class="fa fa-edit"></i></a>
                                        {% endif %}
                                        {% if event['isDuplicatable'] %}
                                            <a href="{{ siteurl }}/events/duplicate/{{ event['id'] }}" class="btn btn-info btn-with-spinner" title="{% trans 'duplizieren' %}" data-toggle="tooltip" data-placement="top"><i class="fa fa-copy"></i></a>
                                        {% endif %}
                                        <a href="#" class="btn btn-danger btn-modal-delete" data-confirm-uri="/events" data-element-id="{{ event['id'] }}" title="{% trans 'löschen' %}" data-toggle="tooltip" data-placement="top"><i class="fa fa-trash"></i></a>
                                    </div>
                                </td>
                            </tr>
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="5" align="center">{% trans 'Keine Einträge gefunden.' %}</td>
                        </tr>
                    {% endif %}
                    </tbody>
                </table>
                {% if events|length > 0 %}
                    {% include 'core/pagination.twig' %}
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}

{% block helpmodal %}
    <p>Hier sollen Erklärungen für die Seminare stehen.</p>
{% endblock %}